<!DOCTYPE html>
<html>
<head>
    <title>localStorage Inspector</title>
    <style>
        body { font-family: Arial, sans-serif; margin: 20px; }
        .container { max-width: 800px; margin: 0 auto; }
        .data-block { background: #f5f5f5; padding: 15px; margin: 10px 0; border-radius: 5px; }
        pre { white-space: pre-wrap; word-wrap: break-word; }
        button { background: #007cba; color: white; padding: 10px 20px; border: none; border-radius: 5px; cursor: pointer; margin: 5px; }
        button:hover { background: #005a87; }
        .error { color: red; background: #ffe6e6; padding: 10px; border-radius: 5px; }
        .success { color: green; background: #e6ffe6; padding: 10px; border-radius: 5px; }
    </style>
</head>
<body>
    <div class="container">
        <h1>üîç localStorage Inspector</h1>
        <p>This tool helps diagnose localStorage issues with the comprehensive assessment form.</p>
        
        <div class="data-block">
            <h3>Quick Actions:</h3>
            <button onclick="showAllStorage()">üîç Show All localStorage</button>
            <button onclick="showAssessmentData()">üìã Show Assessment Data</button>
            <button onclick="clearAssessmentData()">üóëÔ∏è Clear Assessment Data</button>
            <button onclick="clearAllStorage()">üí• Clear All localStorage</button>
        </div>

        <div id="results"></div>
        
        <div class="data-block">
            <h3>Manual localStorage Check:</h3>
            <input type="text" id="keyInput" placeholder="Enter localStorage key" style="width: 300px; padding: 5px;">
            <button onclick="getStorageValue()">Get Value</button>
        </div>
    </div>

    <script>
        function showResults(html, type = 'info') {
            const results = document.getElementById('results');
            const className = type === 'error' ? 'error' : type === 'success' ? 'success' : 'data-block';
            results.innerHTML = `<div class="${className}">${html}</div>`;
        }

        function showAllStorage() {
            let html = '<h3>üì¶ All localStorage Contents:</h3>';
            
            if (localStorage.length === 0) {
                html += '<p><em>localStorage is empty</em></p>';
            } else {
                html += `<p><strong>Found ${localStorage.length} items in localStorage:</strong></p>`;
                
                for (let i = 0; i < localStorage.length; i++) {
                    const key = localStorage.key(i);
                    const value = localStorage.getItem(key);
                    
                    html += `<div style="margin: 10px 0; padding: 10px; background: white; border-left: 4px solid #007cba;">`;
                    html += `<strong>Key:</strong> ${key}<br>`;
                    html += `<strong>Size:</strong> ${value.length} characters<br>`;
                    html += `<strong>Value Preview:</strong> <code>${value.substring(0, 100)}${value.length > 100 ? '...' : ''}</code>`;
                    html += `</div>`;
                }
            }
            
            showResults(html);
        }

        function showAssessmentData() {
            const key = 'comprehensive_assessment_data';
            const data = localStorage.getItem(key);
            
            let html = `<h3>üìã Assessment Data Analysis:</h3>`;
            
            if (!data) {
                html += '<p><em>No comprehensive_assessment_data found in localStorage</em></p>';
                showResults(html, 'success');
                return;
            }
            
            try {
                const parsed = JSON.parse(data);
                const fieldCount = Object.keys(parsed).length;
                
                html += `<p><strong>‚úÖ Assessment data found!</strong></p>`;
                html += `<p><strong>Total fields:</strong> ${fieldCount}</p>`;
                html += `<p><strong>Data size:</strong> ${data.length} characters</p>`;
                
                html += `<h4>üîç Field Analysis:</h4>`;
                html += `<div style="background: white; padding: 10px; border-radius: 5px;">`;
                
                // Key demographic fields
                const keyFields = ['fullName', 'email', 'dateOfBirth', 'gender'];
                keyFields.forEach(field => {
                    if (parsed[field]) {
                        html += `<div><strong>${field}:</strong> <code>${parsed[field]}</code></div>`;
                    }
                });
                
                html += `</div>`;
                
                html += `<h4>üìä All Fields Summary:</h4>`;
                html += `<div style="background: white; padding: 10px; border-radius: 5px; max-height: 300px; overflow-y: auto;">`;
                
                Object.keys(parsed).sort().forEach(key => {
                    const value = parsed[key];
                    const valueStr = typeof value === 'object' ? JSON.stringify(value) : String(value);
                    html += `<div style="margin: 2px 0;"><strong>${key}:</strong> <code>${valueStr.substring(0, 50)}${valueStr.length > 50 ? '...' : ''}</code></div>`;
                });
                
                html += `</div>`;
                
                html += `<h4>üîé Raw JSON Data:</h4>`;
                html += `<pre style="background: white; padding: 10px; border-radius: 5px; max-height: 200px; overflow-y: auto; font-size: 12px;">${JSON.stringify(parsed, null, 2)}</pre>`;
                
            } catch (error) {
                html += `<p><strong>‚ùå Error parsing JSON:</strong> ${error.message}</p>`;
                html += `<p><strong>Raw data:</strong></p>`;
                html += `<pre style="background: white; padding: 10px; border-radius: 5px; max-height: 200px; overflow-y: auto;">${data}</pre>`;
            }
            
            showResults(html);
        }

        function clearAssessmentData() {
            const key = 'comprehensive_assessment_data';
            const hadData = localStorage.getItem(key) !== null;
            
            localStorage.removeItem(key);
            
            const message = hadData 
                ? '‚úÖ Assessment data cleared successfully!' 
                : '‚ÑπÔ∏è No assessment data was found to clear.';
            
            showResults(`<h3>üóëÔ∏è Clear Assessment Data</h3><p>${message}</p>`, 'success');
        }

        function clearAllStorage() {
            const itemCount = localStorage.length;
            localStorage.clear();
            
            showResults(`<h3>üí• Clear All localStorage</h3><p>‚úÖ Cleared ${itemCount} items from localStorage.</p>`, 'success');
        }

        function getStorageValue() {
            const key = document.getElementById('keyInput').value.trim();
            if (!key) {
                showResults('<p>‚ùå Please enter a localStorage key</p>', 'error');
                return;
            }
            
            const value = localStorage.getItem(key);
            
            let html = `<h3>üîç Manual Key Lookup</h3>`;
            html += `<p><strong>Key:</strong> <code>${key}</code></p>`;
            
            if (value === null) {
                html += `<p>‚ùå Key not found in localStorage</p>`;
            } else {
                html += `<p><strong>Value found!</strong></p>`;
                html += `<p><strong>Size:</strong> ${value.length} characters</p>`;
                html += `<pre style="background: white; padding: 10px; border-radius: 5px; max-height: 300px; overflow-y: auto;">${value}</pre>`;
            }
            
            showResults(html);
        }

        // Auto-load on page load
        window.addEventListener('load', function() {
            showAllStorage();
        });
    </script>
</body>
</html>
